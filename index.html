<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Creator Clash ‚Äî Autobattler</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta
      name="description"
      content="Lightweight autobattler prototype ‚Äî gacha, merge dupes, and fight Dollar Kuning."
    />
    <meta name="theme-color" content="#08121b" />
    <link rel="stylesheet" href="style.css" />
    <!-- Phaser CDN -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
    <!-- Inter font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;900&display=swap"
      rel="stylesheet"
    />
    <!-- Icons & Social -->
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <!-- Ably Realtime (for remote control) -->
    <script src="https://cdn.ably.com/lib/ably.min-1.js"></script>
    <meta property="og:title" content="Creator Clash ‚Äî Autobattler" />
    <meta
      property="og:description"
      content="Gacha, merge, and autobattle your squad vs Dollar Kuning."
    />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/og-image.svg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Creator Clash ‚Äî Autobattler" />
    <meta
      name="twitter:description"
      content="Gacha, merge, and autobattle your squad vs Dollar Kuning."
    />
    <meta name="twitter:image" content="/og-image.svg" />
  </head>
  <body>
    <div id="root">
      <!-- HEADER -->
      <header class="topbar">
        <div class="topbar-inner">
          <div class="title">
            <div class="title-main">Creator Clash</div>
            <div class="title-sub">Autobattler ‚Ä¢ Gacha ‚Ä¢ Merge Dupe</div>
          </div>
          <div class="currency">
            <div class="currency-label">üí∞ Crystals</div>
            <div id="crystals" class="currency-value">900</div>
            <div class="currency-label" style="margin-left: 14px">
              üî∑ Shards
            </div>
            <div id="shards" class="currency-value">0</div>
            <div class="currency-label" style="margin-left: 14px">üì° Room</div>
            <div
              id="roomCodeHeader"
              class="currency-value"
              title="Remote room code"
            >
              (off)
            </div>
            <button
              id="toggleSfxBtn"
              class="btn-secondary"
              title="Toggle sound effects"
              style="margin-left: 10px"
            >
              üîä
            </button>
          </div>
        </div>
      </header>

      <!-- MAIN CONTENT -->
      <main class="main">
        <!-- PHASER CANVAS -->
        <div id="game-container" class="canvas-wrap"></div>

        <!-- UI PANEL (glass) -->
        <aside class="ui-panel" aria-hidden="false">
          <!-- Gacha area -->
          <div class="gacha-section">
            <div class="gacha-top">‚ú® Event Banner</div>
            <div class="gacha-controls">
              <div class="gacha-left">
                <div class="pull-options">
                  <label for="pullCount">Pull</label>
                  <select id="pullCount" class="select">
                    <option value="1">1x</option>
                    <option value="10">10x</option>
                  </select>
                </div>
                <div id="lastPull" class="last-pull">Last: ‚Äî</div>
                <div id="ratesInfo" class="last-pull"></div>
                <div id="pityInfo" class="last-pull"></div>
              </div>

              <div class="gacha-right">
                <!-- changed to .btn-gacha (UI kit) -->
                <button id="gachaBtn" class="btn-gacha" aria-pressed="false">
                  <span class="gacha-btn-inner">üé∞ GACHA</span>
                  <span class="gacha-sheen" aria-hidden="true"></span>
                </button>
              </div>
            </div>
          </div>

          <!-- TEAM -->
          <div class="panel-block">
            <div class="panel-title">Your Squad</div>
            <div style="margin-bottom: 8px">
              <button id="resetBtn" class="btn-outline">‚ôªÔ∏è Reset Team</button>
              <button
                id="healTeamBtn"
                class="btn-outline"
                title="Heal all members (cost based on missing HP)"
              >
                ü©π Heal Team
              </button>
            </div>
            <div id="teamList" class="char-list">
              <div class="placeholder">No members yet ‚Äî gacha dulu!</div>
            </div>
          </div>

          <!-- SETTINGS -->
          <div class="panel-block" id="settingsPanel">
            <div class="panel-title">Settings</div>
            <div style="display: flex; flex-direction: column; gap: 8px">
              <div style="display: flex; gap: 8px; flex-wrap: wrap">
                <label
                  >Common
                  <input
                    id="rateCommon"
                    type="number"
                    step="0.01"
                    min="0"
                    max="1"
                    style="width: 80px"
                /></label>
                <label
                  >Rare
                  <input
                    id="rateRare"
                    type="number"
                    step="0.01"
                    min="0"
                    max="1"
                    style="width: 80px"
                /></label>
                <label
                  >Epic
                  <input
                    id="rateEpic"
                    type="number"
                    step="0.01"
                    min="0"
                    max="1"
                    style="width: 80px"
                /></label>
                <label
                  >Legend
                  <input
                    id="rateLegend"
                    type="number"
                    step="0.01"
                    min="0"
                    max="1"
                    style="width: 80px"
                /></label>
              </div>
              <small class="last-pull"
                >Tips: Rates should sum to 1.0; values will be normalized if
                not.</small
              >
              <div
                style="
                  display: flex;
                  gap: 8px;
                  flex-wrap: wrap;
                  margin-top: 6px;
                "
              >
                <label
                  >Epic Pity
                  <input
                    id="pityEpicInput"
                    type="number"
                    step="1"
                    min="1"
                    max="999"
                    style="width: 90px"
                /></label>
                <label
                  >Legend Pity
                  <input
                    id="pityLegendInput"
                    type="number"
                    step="1"
                    min="1"
                    max="999"
                    style="width: 90px"
                /></label>
              </div>
              <div style="display: flex; gap: 8px; margin-top: 6px">
                <button id="saveSettingsBtn" class="btn-outline">
                  üíæ Save Settings
                </button>
                <button
                  id="saveGameBtn"
                  class="btn-outline"
                  title="Manual save game state"
                >
                  üíæ Save Game
                </button>
                <button id="defaultSettingsBtn" class="btn-outline">
                  ‚Ü© Reset Defaults
                </button>
                <button
                  id="clearSaveBtn"
                  class="btn-outline"
                  title="Clear local save (keep page)"
                >
                  üßπ Clear Save
                </button>
                <button
                  id="fullResetBtn"
                  class="btn-outline"
                  title="Wipe all & reload page"
                >
                  ‚ôªÔ∏è Full Reset
                </button>
              </div>

              <!-- Remote Control (opt-in) -->
              <div
                style="
                  margin-top: 10px;
                  padding-top: 10px;
                  border-top: 1px dashed rgba(255, 255, 255, 0.15);
                "
              >
                <div style="font-weight: 700; margin-bottom: 6px">
                  Remote Control
                </div>
                <label style="display: flex; align-items: center; gap: 8px">
                  <input type="checkbox" id="allowRemoteChk" /> Allow Remote
                  Events (opt-in)
                </label>
                <div
                  style="
                    display: flex;
                    gap: 6px;
                    align-items: center;
                    margin-top: 6px;
                  "
                >
                  <label
                    >Room
                    <input
                      id="roomCodeInput"
                      type="text"
                      readonly
                      style="width: 120px"
                      placeholder="(off)"
                  /></label>
                  <button
                    id="copyRoomBtn"
                    class="btn-outline"
                    title="Copy room code"
                  >
                    Copy
                  </button>
                  <a
                    id="openControlLink"
                    class="btn-outline"
                    href="control.html"
                    target="_blank"
                    rel="noopener"
                    >Open Control</a
                  >
                </div>
                <small class="last-pull"
                  >Share room code ke panel kontrol. Matikan kapan saja.</small
                >
              </div>
            </div>
          </div>

          <!-- DEVELOPER (hidden toggle: Ctrl+Alt+D) -->
          <div class="panel-block" id="devPanel" style="display: none">
            <div class="panel-title">Developer</div>
            <small class="last-pull"
              >Press Ctrl+Alt+D to toggle this panel</small
            >
            <div
              style="
                display: flex;
                flex-direction: column;
                gap: 10px;
                margin-top: 8px;
              "
            >
              <div style="display: flex; gap: 6px; flex-wrap: wrap">
                <button id="devC100" class="btn-outline">+100üí∞</button>
                <button id="devC1000" class="btn-outline">+1000üí∞</button>
                <button id="devS10" class="btn-outline">+10üî∑</button>
                <button id="devHealTeam" class="btn-outline">
                  Full Heal Team
                </button>
              </div>
              <div style="display: flex; gap: 6px; flex-wrap: wrap">
                <button id="devAddCommon" class="btn-secondary">
                  Add Common
                </button>
                <button id="devAddRare" class="btn-secondary">Add Rare</button>
                <button id="devAddEpic" class="btn-secondary">Add Epic</button>
                <button id="devAddLegend" class="btn-secondary">
                  Add Legend
                </button>
              </div>
              <div
                style="
                  display: flex;
                  gap: 6px;
                  flex-wrap: wrap;
                  align-items: center;
                "
              >
                <label
                  >By Name
                  <input
                    id="devNameInput"
                    type="text"
                    placeholder="Name"
                    style="width: 160px"
                /></label>
                <button id="devAddByName" class="btn-outline">Add</button>
              </div>
              <div
                style="
                  display: flex;
                  gap: 6px;
                  flex-wrap: wrap;
                  align-items: center;
                "
              >
                <label
                  >Stage
                  <input
                    id="devStageInput"
                    type="number"
                    min="1"
                    step="1"
                    style="width: 90px"
                /></label>
                <button id="devSetStage" class="btn-outline">Set Stage</button>
                <label
                  >Enemy HP
                  <input
                    id="devEnemyHpInput"
                    type="number"
                    min="0"
                    step="1"
                    style="width: 110px"
                /></label>
                <button id="devSetEnemyHp" class="btn-outline">Set HP</button>
              </div>
              <div style="display: flex; gap: 6px; flex-wrap: wrap">
                <button id="devForceWin" class="btn-primary">
                  Force Victory
                </button>
                <button id="devToggleStream" class="btn-outline">
                  Toggle Streamer Mode
                </button>
              </div>
            </div>
          </div>

          <!-- CONTROLS -->
          <div class="panel-block">
            <div class="controls-row">
              <div
                id="stageLabel"
                class="btn-secondary"
                aria-hidden="true"
                style="cursor: default"
              >
                Stage 1
              </div>
              <!-- use UI kit classes -->
              <button id="battleBtn" class="btn-primary">
                ‚öîÔ∏è Battle vs Dollar Kuning
              </button>
            </div>
          </div>

          <!-- BATTLE LOG -->
          <div class="panel-block">
            <div class="panel-title">Battle Log</div>
            <div id="battleLog" class="battle-log">‚Äî</div>
          </div>

          <!-- REMOTE ACTIONS AUDIT -->
          <div class="panel-block" id="remoteAuditPanel">
            <div
              class="panel-title"
              style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                gap: 8px;
              "
            >
              <span>Remote Actions</span>
              <span
                id="remoteAiBadge"
                style="
                  font-size: 11px;
                  font-weight: 700;
                  padding: 3px 6px;
                  border-radius: 6px;
                  background: linear-gradient(90deg, #3b82f6, #7b9dff);
                  color: #fff;
                  letter-spacing: 0.5px;
                "
                >LIVE</span
              >
            </div>
            <div
              id="remoteAuditLog"
              class="battle-log remote-audit"
              style="min-height: 70px"
            >
              ‚Äî
            </div>
          </div>
        </aside>
      </main>

      <footer class="footer">
        <small>Created By Jozzu RPGs üëë</small>
      </footer>
    </div>

    <!-- game logic (modular) -->
    <script type="module" src="src/main.js"></script>

    <!-- control panel (standalone) will be loaded from control.html -->

    <!-- Victory Recap Modal -->
    <div
      id="victoryModal"
      style="
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.55);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      "
      aria-hidden="true"
    >
      <div
        id="victoryCard"
        style="
          background: rgba(255, 255, 255, 0.06);
          backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.2);
          border-radius: 12px;
          padding: 16px 20px;
          width: min(420px, 90%);
          color: #cfeaff;
          text-align: center;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
          opacity: 0;
          transform: scale(0.96);
          transition: opacity 180ms ease,
            transform 220ms cubic-bezier(0.2, 0.8, 0.2, 1);
        "
      >
        <div style="font-size: 22px; font-weight: 700; margin-bottom: 6px">
          üéâ Victory!
        </div>
        <div
          id="victoryText"
          style="font-size: 14px; opacity: 0.9; margin-bottom: 12px"
        >
          Stage 1 cleared ‚Ä¢ Reward +120 Crystals
        </div>
        <button id="victoryNextBtn" class="btn-primary" style="width: 100%">
          Next Stage
        </button>
      </div>
    </div>

    <!-- Game Over Modal -->
    <div
      id="gameOverModal"
      style="
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.55);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      "
      aria-hidden="true"
    >
      <div
        id="gameOverCard"
        style="
          background: rgba(255, 255, 255, 0.06);
          backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.2);
          border-radius: 12px;
          padding: 16px 20px;
          width: min(420px, 90%);
          color: #cfeaff;
          text-align: center;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
          opacity: 0;
          transform: scale(0.96);
          transition: opacity 180ms ease,
            transform 220ms cubic-bezier(0.2, 0.8, 0.2, 1);
        "
      >
        <div style="font-size: 22px; font-weight: 800; margin-bottom: 6px">
          üíÄ Game Over
        </div>
        <div
          id="gameOverText"
          style="font-size: 14px; opacity: 0.9; margin-bottom: 12px"
        >
          Tim kamu kalah di Stage 1.
        </div>
        <div style="display: flex; gap: 8px">
          <button id="gameOverResetBtn" class="btn-primary" style="flex: 1">
            ‚Ü© Reset Game
          </button>
          <button id="gameOverCloseBtn" class="btn-outline" style="flex: 1">
            Close
          </button>
        </div>
      </div>
    </div>

    <!-- Streamer Mode Modal (hotkey: S) -->
    <div
      id="streamerModal"
      style="
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.55);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      "
      aria-hidden="true"
    >
      <div
        id="streamerCard"
        style="
          background: rgba(255, 255, 255, 0.06);
          backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 255, 255, 0.2);
          border-radius: 12px;
          padding: 16px 20px;
          width: min(460px, 92%);
          color: #cfeaff;
          text-align: left;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
          opacity: 0;
          transform: scale(0.96);
          transition: opacity 180ms ease,
            transform 220ms cubic-bezier(0.2, 0.8, 0.2, 1);
        "
      >
        <div
          style="
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 8px;
            text-align: center;
          "
        >
          üé• Streamer Mode
        </div>
        <div
          style="
            font-size: 13px;
            opacity: 0.9;
            margin-bottom: 12px;
            text-align: center;
          "
        >
          Tekan <b>S</b> untuk membuka/menutup menu ini. Preferensi disimpan
          otomatis.
        </div>
        <div style="display: flex; gap: 16px; flex-wrap: wrap">
          <div style="flex: 1 1 220px">
            <div style="font-weight: 700; margin-bottom: 8px">HUD Elements</div>
            <label
              style="
                display: flex;
                align-items: center;
                gap: 8px;
                margin: 6px 0;
              "
            >
              <input id="streamerHideSettingsChk" type="checkbox" /> Sembunyikan
              panel Settings
            </label>
            <label
              style="
                display: flex;
                align-items: center;
                gap: 8px;
                margin: 6px 0;
              "
            >
              <input id="streamerHideLogChk" type="checkbox" /> Sembunyikan
              Battle Log
            </label>
            <label
              style="
                display: flex;
                align-items: center;
                gap: 8px;
                margin: 6px 0;
              "
            >
              <input id="streamerHideRatesChk" type="checkbox" /> Sembunyikan
              Rates & Pity info
            </label>
            <label
              style="
                display: flex;
                align-items: center;
                gap: 8px;
                margin: 6px 0;
              "
            >
              <input id="streamerHideCurrencyChk" type="checkbox" /> Sembunyikan
              bar Currency
            </label>
            <label
              style="
                display: flex;
                align-items: center;
                gap: 8px;
                margin: 6px 0;
              "
            >
              <input id="streamerHideGachaChk" type="checkbox" /> Sembunyikan
              panel Gacha
            </label>
          </div>
          <div style="flex: 1 1 200px">
            <div style="font-weight: 700; margin-bottom: 8px">
              Quick Actions
            </div>
            <label
              style="
                display: flex;
                align-items: center;
                gap: 8px;
                margin: 6px 0;
              "
            >
              <input id="streamerMinimalChk" type="checkbox" /> Minimal mode
              (hide all, dim)
            </label>
            <label
              style="
                display: flex;
                align-items: center;
                gap: 8px;
                margin: 6px 0;
              "
            >
              <input id="streamerRemoteLockChk" type="checkbox" /> Lock remote
              (block actions)
            </label>
            <label
              style="
                display: flex;
                align-items: center;
                gap: 8px;
                margin: 6px 0;
                font-size: 12px;
              "
            >
              Permission
              <select
                id="streamerRemoteLevelSel"
                style="flex: 1; min-width: 110px"
              >
                <option value="1">Level 1 (FX / Msg)</option>
                <option value="2" selected>Level 2 (+Resources)</option>
                <option value="3">Level 3 (Stage / Force)</option>
              </select>
            </label>
            <div
              style="
                display: flex;
                align-items: center;
                gap: 8px;
                margin: 8px 0;
              "
            >
              <label for="streamerDimRange" style="min-width: 110px"
                >Dim overlay</label
              >
              <input
                id="streamerDimRange"
                type="range"
                min="0"
                max="0.7"
                step="0.05"
                style="flex: 1"
              />
            </div>
            <div
              style="display: flex; gap: 6px; flex-wrap: wrap; margin: 8px 0"
            >
              <button id="streamerSaveGameBtn" class="btn-outline">
                üíæ Save Game
              </button>
              <button id="streamerFullResetBtn" class="btn-outline">
                ‚ôªÔ∏è Full Reset
              </button>
            </div>
            <button
              id="streamerCloseBtn"
              class="btn-primary"
              style="width: 100%"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Streamer Dim Overlay -->
    <div
      id="dimOverlay"
      style="
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0);
        pointer-events: none;
        z-index: 900;
        display: block;
      "
    ></div>

    <!-- Loading Save Data Overlay -->
    <div
      id="loadingOverlay"
      style="
        position: fixed;
        inset: 0;
        background: rgba(7, 16, 24, 0.95);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        opacity: 1;
        transition: opacity 0.3s ease;
      "
    >
      <div style="text-align: center; color: #cfeaff">
        <div
          style="
            font-size: 48px;
            margin-bottom: 16px;
            animation: pulse 1.5s ease-in-out infinite;
          "
        >
          üíæ
        </div>
        <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px">
          Loading Save Data
        </div>
        <div style="font-size: 14px; opacity: 0.7">Memuat progres Anda...</div>
        <div
          style="
            margin-top: 16px;
            display: flex;
            gap: 8px;
            justify-content: center;
          "
        >
          <div
            style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background: #66c2ff;
              animation: bounce 0.6s ease-in-out infinite;
            "
          ></div>
          <div
            style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background: #66c2ff;
              animation: bounce 0.6s ease-in-out 0.2s infinite;
            "
          ></div>
          <div
            style="
              width: 8px;
              height: 8px;
              border-radius: 50%;
              background: #66c2ff;
              animation: bounce 0.6s ease-in-out 0.4s infinite;
            "
          ></div>
        </div>
      </div>
    </div>

    <style>
      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(1.1);
          opacity: 0.8;
        }
      }
      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }
    </style>
  </body>
</html>
